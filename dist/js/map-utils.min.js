!function(t){"function"==typeof define&&define.amd?define("projections/euclidean",t):t()}(function(){var t=function(){var t=256;this.pixelOrigin=new google.maps.Point(t/2,t/2),this.pixelsPerLonDegree=t/360,this.pixelsPerLonRadian=t/(2*Math.PI),this.scaleLat=2,this.scaleLng=1};t.prototype={pixelOrigin:new google.maps.Point(0,0),pixelsPerLonDegree:0,pixelsPerLonRadian:0,scaleLat:0,scaleLng:0,offsetLat:0,offsetLng:0,fromLatLngToPoint:function(t,e){var o=e||new google.maps.Point(0,0);return o.x=this.pixelOrigin.x+(t.lng()+this.offsetLng)*this.pixelsPerLonDegree*this.scaleLng,o.y=this.pixelOrigin.y+(-1*t.lat()+this.offsetLat)*this.pixelsPerLonDegree*this.scaleLat,o},fromPointToLatLng:function(t){var e=(t.x-this.pixelOrigin.x)/this.pixelsPerLonDegree/this.scaleLng-this.offsetLng,o=-1*(t.y-this.pixelOrigin.y)/this.pixelsPerLonDegree/this.scaleLat-this.offsetLat;return new google.maps.LatLng(o,e,!0)}},google.maps.EuclideanProjection=t}),function(t){"function"==typeof define&&define.amd?define("maptypes/coordinate",["../projections/euclidean"],t):t()}(function(){var t=function(t){this.url=t};t.prototype={name:"Coordinate Map Type",minZoom:0,maxZoom:5,tileSize:new google.maps.Size(256,256),projection:new google.maps.EuclideanProjection,url:"",getTile:function(t,e,o){var i=o.createElement("div"),n=1<<e,a=t.x,s=t.y;if(0>s||s>=n||0>a||a>=n||e>4)return i.style.height="256px",i.style.width="256px",i.style.backgroundColor="#fcf8ed",i.style.fontSize="9",i.style.textAlign="center",i.innerHTML=e>4?"Sorry, we have no map <br /> images for this zoom level.":"",i;for(var r=0,p="t";e>r;r++)n/=2,n>s?n>a?p+="q":(p+="r",a-=n):n>a?(p+="t",s-=n):(p+="s",a-=n,s-=n);return i.innerHTML='<img src="http://www.thekremercollection.com/art/img/paintings/zoom/portrait_of_a_spanish_grande_tiles_14/'+p+'.jpg" alt="" width="256" height="256" />',i}},google.maps.CoordinateMapType=t}),function(t){"function"==typeof define&&define.amd?define("maptypes/greyscale",["../projections/euclidean"],t):t()}(function(){var t=function(t){this.url=t};t.prototype={name:"Greyscale Map Type",minZoom:0,maxZoom:5,tileSize:new google.maps.Size(256,256),projection:new google.maps.EuclideanProjection,url:"",getTile:function(t,e,o){var i=o.createElement("div"),n=1<<e,a=t.x,s=t.y;if(0>s||s>=n||0>a||a>=n||e>4)return i.style.height="256px",i.style.width="256px",i.style.backgroundColor="#fcf8ed",i.style.fontSize="9",i.style.textAlign="center",i.innerHTML=e>4?"Sorry, we have no map <br /> images for this zoom level.":"",i;for(var r=0,p="t";e>r;r++)n/=2,n>s?n>a?p+="q":(p+="r",a-=n):n>a?(p+="t",s-=n):(p+="s",a-=n,s-=n);var h=o.createElement("canvas"),l=h.getContext("2d"),g=new Image;return h.setAttribute("width",256),h.setAttribute("height",256),g.crossOrigin="anonymous",g.src="http://www.thekremercollection.com/art/img/paintings/zoom/portrait_of_a_spanish_grande_tiles_14/"+p+".jpg",g.onload=function(){l.drawImage(g,0,0);for(var t=l.getImageData(0,0,256,256),e=t.data,o=0,i=0,n=e.length;n>o;o+=4)i=.3*e[o]+.59*e[o+1]+.11*e[o+2],e[o]=i,e[o+1]=i,e[o+2]=i;l.putImageData(t,0,0)},i.appendChild(h),i}},google.maps.GreyscaleMapType=t}),function(t){"function"==typeof define&&define.amd?define("utils/dimensions",t):t()}(function(){function t(t){this._view=t}t.prototype._view=null,t.prototype.fromLatLngToDivPixel=function(t){return this._view.getProjection().fromLatLngToDivPixel(t)},t.prototype.getScaleRate=function(t,e){return"zoom"in t&&("min"in t.zoom&&t.zoom.min>e?console.log("Zoom out of range for "+t.type):"max"in t.zoom&&e>t.zoom.max&&console.log("Zoom out of range for "+t.type),"adjusted"in t.zoom?e-=t.zoom.adjusted:"min"in t.zoom&&(e-=t.zoom.min)),1<<e},t.prototype.ellipse=function(t,e){var o,i,n,a,s,r,p=this.getScaleRate(t,e.zoom);if(t.center instanceof google.maps.LatLng||t.position instanceof google.maps.LatLng)r=this.fromLatLngToDivPixel(t.center||t.position);else{if(!(t.center instanceof google.maps.Point||t.position instanceof google.maps.Point))throw new Error("Unrecognized data type");r=t.center||t.position}a=p*t.rx,s=p*t.ry,n=p*t.radius,o=r.x-e.left,i=r.y-e.top;var h=this.fromLatLngToDivPixel(e.bounds.getNorthEast()),l=this.fromLatLngToDivPixel(e.bounds.getSouthWest());return Math.pow(l.x-e.left-o,2)/Math.pow(a||n,2)+Math.pow(l.y-e.top-i,2)/Math.pow(s||n,2)<1&&Math.pow(l.x-e.left-o,2)/Math.pow(a||n,2)+Math.pow(h.y-e.top-i,2)/Math.pow(s||n,2)<1&&Math.pow(h.x-e.left-o,2)/Math.pow(a||n,2)+Math.pow(l.y-e.top-i,2)/Math.pow(s||n,2)<1&&Math.pow(h.x-e.left-o,2)/Math.pow(a||n,2)+Math.pow(h.y-e.top-i,2)/Math.pow(s||n,2)<1?this.fillAllMap(e):{figure:{x:o,y:i,rx:a,ry:s,r:n,data:t.data},dimension:{left:(a||n)-o,top:(s||n)-i,right:(a||n)+o-e.worldWidth,bottom:(s||n)+i-e.worldWidth}}},t.prototype.circle=function(t,e){return this.ellipse(t,e)},t.prototype.text=function(t,e){var o=this.fromLatLngToDivPixel(t.position),i=o.x-e.left,n=o.y-e.top;return{figure:{x:i,y:n,text:t.text}}},t.prototype.polygon=function(t,e){for(var o,i=[],n=0,a=t.position.length;a>n;n++)o=this.fromLatLngToDivPixel(t.position[n]),i.push([0===n?"M":"L",o.x-e.left,o.y-e.top]);return i.push(["Z"]),{figure:{path:Raphael.pathToRelative(i)}}},t.prototype.path=function(t,e){for(var o=this.getScaleRate(t,e.zoom),i=this.fromLatLngToDivPixel(t.position),n=Raphael.pathToRelative(Raphael.parsePathString(t.path)),a=[],s=0,r=n.length;r>s;s++)for(var p=0,h=n[s].length;h>p;p++)0===p?a[s]=[n[s][p]]:a[s].push(0===s&&1===p?i.x-e.left+n[s][p]*o:0===s&&2===p?i.y-e.top+n[s][p]*o:n[s][p]*o);return{figure:{path:a}}},t.prototype.rect=function(t,e){var o,i,n,a,s,r,p,h,l,g,c=this.getScaleRate(t,e.zoom);if(t.position instanceof google.maps.LatLngBounds){if(t.position.contains(e.bounds.getNorthEast())&&t.position.contains(e.bounds.getSouthWest()))return this.fillAllMap(e);o=this.fromLatLngToDivPixel(t.position.getNorthEast()),i=this.fromLatLngToDivPixel(t.position.getSouthWest()),r=o.x-i.x,s=i.y-o.y,n=i.x-e.left,a=o.y-e.top,p=c*t.radius,g=1}else{if(t.position instanceof google.maps.LatLng)h=this.fromLatLngToDivPixel(t.position),l=0,g=1;else if(t.position instanceof google.maps.Point)h=t.position,l=0,g=-1;else if(t.center instanceof google.maps.LatLng)h=this.fromLatLngToDivPixel(t.center),l=.5,g=1;else{if(!(t.center instanceof google.maps.Point))throw new Error("Unrecognized data type");h=t.center,l=.5,g=-1}if(o=this.fromLatLngToDivPixel(e.bounds.getNorthEast()),i=this.fromLatLngToDivPixel(e.bounds.getSouthWest()),r=t.size.width*c,s=t.size.height*c,p=t.radius*c,n=h.x-r*l-e.left,a=h.y-s*l-e.top,n<=i.x-e.left&&a<=o.y-e.top&&n+r>=o.x-e.left&&a+s>=i.y-e.top)return this.fillAllMap(e)}return{figure:{x:n,y:a,width:r,height:s,r:p,src:t.src},dimension:{left:-n,top:-a,right:r+n-e.worldWidth*g,bottom:s+a-e.worldWidth*g},type:t.type}},t.prototype.image=function(t,e){return this.rect(t,e)},t.prototype.fillAllMap=function(t){var e,o,i,n,a,s;return e=this.fromLatLngToDivPixel(t.bounds.getNorthEast()),o=this.fromLatLngToDivPixel(t.bounds.getSouthWest()),s=e.x-o.x,a=o.y-e.y,i=o.x-t.left,n=e.y-t.top,{figure:{x:i,y:n,width:s,height:a,r:0},dimension:{left:-i,top:-n,right:s+i-t.worldWidth,bottom:a+n-t.worldWidth},type:"rect"}},t.prototype.piechart=function(t,e){return this.ellipse(t,e)},t.prototype.barchart=function(t,e){return this.rect(t,e)},t.prototype.hbarchart=function(t,e){return this.rect(t,e)},t.prototype.linechart=function(t,e){return this.rect(t,e)},t.prototype.dotchart=function(t,e){return this.rect(t,e)},google.maps.Dimensions=t}),function(t){"function"==typeof define&&define.amd?define("overlays/canvas",["../utils/dimensions"],t):t()}(function(){function t(t){this.setMap(t.map),this.shapes=t.shapes||[],this.intervals=[],this.dimensions=new google.maps.Dimensions(this)}t.prototype=new google.maps.OverlayView,t.prototype.onAdd=function(){var t=this.getProjection(),e=t.fromLatLngToDivPixel(new google.maps.LatLng(0,0)),o=t.getWorldWidth();this.canvas=document.createElement("canvas"),this.canvas.style.border="none",this.canvas.style.position="absolute",this.canvas.style.overflow="visible",this.canvas.width=o,this.canvas.height=o,this.canvas.style.left=e.x-o/2+"px",this.canvas.style.top=e.y-o/2+"px",this.getPanes().overlayImage.appendChild(this.canvas)},t.prototype.draw=function(){function t(t,e,o){e.intervals.push(setInterval(function(){e.shapes[t].drawable.draw(p,{left:y,top:v,right:x,bottom:L,fullWorldWidth:w,fullWorldHeight:P},o[t].figure,r)},e.shapes[t].interval))}for(var e=this.getProjection(),o=e.fromLatLngToDivPixel(new google.maps.LatLng(0,0)),i=this.getMap().getBounds(),n=e.getWorldWidth(),a=o.x-n/2,s=o.y-n/2,r=this.getMap().getZoom(),p=this.canvas.getContext("2d"),h=[],l={left:[0],top:[0],right:[0],bottom:[0]},g=0,c=this.intervals.length;c>g;g++)clearInterval(this.intervals[g]);for(var f=0,d=this.shapes.length;d>f;f++)try{var m=this.dimensions.rect(this.shapes[f],{map:this.getMap(),bounds:i,worldWidth:n,zoom:r,left:a,top:s});"dimension"in m&&(l.left.push(m.dimension.left),l.top.push(m.dimension.top),l.right.push(m.dimension.right),l.bottom.push(m.dimension.bottom)),h.push(m)}catch(u){console.log(u)}var y=Math.max.apply(null,l.left),v=Math.max.apply(null,l.top),x=Math.max.apply(null,l.right),L=Math.max.apply(null,l.bottom),w=y+n+x,P=v+n+L;this.canvas.style.left=a-y+"px",this.canvas.style.top=s-v+"px",this.canvas.width=w,this.canvas.height=P;for(var M=0,b=this.shapes.length;b>M;M++)t(M,this,h)},t.prototype.onRemove=function(){this.canvas.parentNode.removeChild(this.canvas)},google.maps.CanvasOverlay=t}),function(t){"function"==typeof define&&define.amd?define("overlays/raphael",["raphael","../utils/dimensions"],t):t(Raphael)}(function(){function t(t){this.setMap(t.map),this.shapes=t.shapes||[],this.dimensions=new google.maps.Dimensions(this)}t.prototype=new google.maps.OverlayView,t.prototype.onAdd=function(){var t=this.getProjection(),e=t.fromLatLngToDivPixel(new google.maps.LatLng(0,0)),o=t.getWorldWidth();this.div=document.createElement("div"),this.div.style.border="none",this.div.style.position="absolute",this.div.style.overflow="visible",this.div.style.left=e.x-o/2+"px",this.div.style.top=e.y-o/2+"px",this.div.style.width=o+"px",this.div.style.height=o+"px",this.getPanes().overlayImage.appendChild(this.div),this.canvas=Raphael(this.div)},t.prototype.draw=function(){var t=this.getProjection(),e=t.fromLatLngToDivPixel(new google.maps.LatLng(0,0)),o=t.getWorldWidth(),i=this.getMap().getBounds(),n=e.x-o/2,a=e.y-o/2,s=this.getMap().getZoom(),r=[],p=[],h={left:[0],top:[0],right:[0],bottom:[0]};this.canvas.clear();for(var l=0,g=this.shapes.length;g>l;l++)try{var c=this.dimensions[this.shapes[l].type](this.shapes[l],{map:this.getMap(),bounds:i,worldWidth:o,zoom:s,left:n,top:a});"dimension"in c&&(h.left.push(c.dimension.left),h.top.push(c.dimension.top),h.right.push(c.dimension.right),h.bottom.push(c.dimension.bottom)),p.push({data:c.figure,type:c.type||this.shapes[l].type,attr:this.shapes[l].attr,info:this.shapes[l].info})}catch(f){console.log(f)}var d=Math.max.apply(null,h.left),m=Math.max.apply(null,h.top),u=Math.max.apply(null,h.right),y=Math.max.apply(null,h.bottom),v=d+o+u,x=m+o+y;this.div.style.left=n-d+"px",this.div.style.top=a-m+"px",this.div.style.width=v+"px",this.div.style.height=x+"px",this.canvas.setSize(v,x);for(var L=0,w=p.length;w>L;L++)r[L]=this._draw(p[L].type,p[L].data,{left:d,top:m},this.clone(p[L].info)),p[L].attr&&r[L].attr(p[L].attr)},t.prototype.onRemove=function(){this.canvas.clear(),this.div.parentNode.removeChild(this.div)},t.prototype.clone=function(t){return t?JSON.parse(JSON.stringify(t)):{}},t.prototype._draw=function(t,e,o,i){switch(t){case"path":case"polygon":return e.path[0][1]+=o.left,e.path[0][2]+=o.top,this.canvas.path(e.path);case"text":return this.canvas.text(e.x+o.left,e.y+o.top,e.text);case"image":return this.canvas.image(e.src,e.x+o.left,e.y+o.top,e.width,e.height);case"rect":return this.canvas.rect(e.x+o.left,e.y+o.top,e.width,e.height,e.r);case"circle":return this.canvas.circle(e.x+o.left,e.y+o.top,e.r);case"ellipse":return this.canvas.ellipse(e.x+o.left,e.y+o.top,e.rx,e.ry);case"piechart":return this.canvas.piechart(e.x+o.left,e.y+o.top,e.r,i.data);case"barchart":return this.canvas.barchart(e.x+o.left,e.y+o.top,e.width,e.height,i.data,i.param);case"hbarchart":return this.canvas.hbarchart(e.x+o.left,e.y+o.top,e.width,e.height,i.data,i.param);case"linechart":return this.canvas.linechart(e.x+o.left,e.y+o.top,e.width,e.height,i.x,i.y,i.param);case"dotchart":return this.canvas.dotchart(e.x+o.left,e.y+o.top,e.width,e.height,i.xs,i.ys,i.data,i.param);default:throw new Error("Unrecognized data type: "+e.type)}},google.maps.RaphaelOverlayView=t}),require(["maptypes/coordinate","maptypes/greyscale","overlays/canvas","overlays/raphael"],function(){console.log("map-utils loaded!")}),define("map-utils",function(){});
//# sourceMappingURL=map-utils.min.js.map